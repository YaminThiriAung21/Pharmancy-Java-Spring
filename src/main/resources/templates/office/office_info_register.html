<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
	layout:decorator="common/admin_layout">
<head>
<meta charset="ISO-8859-1">
<title>Office Register</title>
</head>
<body>
	<div class="col-lg-12" layout:fragment="content">
		<p id="errorMsg" th:if="${errormsg != null}" th:text="${errormsg}"
			class="sufee-alert alert with-close alert-danger alert-dismissible fade show"></p>
		<p id="successMsg" th:if="${msg != null}" th:utext="${msg}"
			class="sufee-alert alert with-close alert-success alert-dismissible fade show"></p>
		<form
			th:action="@{${T(pec.datacode.AdminPageInfo).OFFICE_INFO_REGISTER.url}}"
			method="post" th:object="${officeDto}" class="form-horizontal"
			enctype="multipart/form-data">

			<div class="card">
				<div class="card-header text-center">
					<strong>Office</strong> Register
				</div>

				<div class="card-body card-block">
					<div class="row form-group">
						<div class="col col-md-3">
							<label for="hf-office-code" class=" form-control-label">Office
								Code</label> <label> <span class="text-danger">*</span>
							</label>
						</div>
						<div class="col-12 col-md-9">
							<input type="text" th:field="*{office_code}"
								th:value="${officeDto.office_code}"
								placeholder="Enter office code..." class="form-control"
								onchange="clearErrorMsg()" maxlength = "45" required> <span
								class="help-block" id="office_code_msg"></span>
						</div>
					</div>
					<div class="row form-group">
						<div class="col col-md-3">
							<label for="hf-office-name" class=" form-control-label">Office
								Name</label> <label> <span class="text-danger">*</span>
							</label>
						</div>
						<div class="col-12 col-md-9">
							<input type="text" th:field="*{office_name}"
								th:value="${officeDto.office_name}"
								placeholder="Enter office name..." class="form-control"
								onchange="clearErrorMsg()" maxlength = "45"> <span class="help-block"
								id="office_name_msg"></span>
						</div>
					</div>
					<div class="row form-group">
						<div class="col col-md-3">
							<label for="hf-office-email-address" class=" form-control-label">Email
								Address</label> <label> <span class="text-danger">*</span>
							</label>
						</div>
						<div class="col-12 col-md-9">
							<input type="text" th:field="*{office_email_address}"
								th:value="${officeDto.office_email_address}"
								placeholder="Enter office email address..." class="form-control"
								onchange="clearErrorMsg()" maxlength = "45"> <span class="help-block"
								id="office_email_address_msg"></span>
						</div>
					</div>
					<div class="row form-group">
						<div class="col col-md-3">
							<label for="hf-office-city" class=" form-control-label">City</label>
							<label> <span class="text-danger">*</span>
							</label>
						</div>
						<div class="col-12 col-md-9">
							<input type="text" th:field="*{office_city}"
								th:vaue="${officeDto.office_city}" placeholder="Enter city..."
								class="form-control" onchange="clearErrorMsg()" maxlength = "45"> <span
								class="help-block" id="office_city_msg"></span>
						</div>
					</div>
					
					<div class="row form-group">
						<div class="col col-md-3">
							<label for="hf-office-phone-number" class=" form-control-label">Phone
							  	Number</label> <label> <span class="text-danger">*</span>
							</label>
						</div>
						<div class="col-12 col-md-9">
							<input type="text" th:field="*{office_phone_number}"
								th:value="${officeDto.office_phone_number}"
								placeholder="Enter phone number..." class="form-control"
								onchange="clearErrorMsg()" maxlength = "45"> <span class="help-block"
								id="office_phone_msg"></span>
						</div>
					</div>
					<div class="row form-group">
						<div class="col col-md-3">
							<label for="hf-office-address" class=" form-control-label">Office
								Address</label> <label> <span class="text-danger">*</span>
							</label>
						</div>
						<div class="col-12 col-md-9">
							<textarea th:field="*{office_address}"
								th:value="${officeDto.office_address}"
								placeholder="Enter office address..." class="form-control"
								onchange="clearErrorMsg()" maxlength = "200"></textarea> <span class="help-block"
								id="office_address_msg"></span>
						</div>
					</div>
					<div class="row form-group">
						<div class="col-md-3">
							<label for="email" class=" form-control-label"> Image </label>
						</div>
						<div class="col-md-9">
							<input type="file" id="file-input" name="file-input"
								onchange="previewFile(this)" class="form-control-file"
								th:field="*{officeimage}" onclick="clearErrorMsg()" /> <span
								class="help-block" id="office_image_name_msg"></span>
							<label id="fileLabel">No file chosen(jpg/jpeg/png/bmp/gif)</label>	
						</div>
					</div>

				</div>
				<div class="card-footer">
					<div class="card-block float-right">
						<button type="submit" name="register" class="btn btn-info btn-md"
							onmouseover="clearErrorMsg()" onclick="return checkValidate()">
							<i class="fa fa-dot-circle-o"></i>Register
						</button>
						<button type="reset" name="clear" onclick="clearing()"
							class="btn btn-danger btn-md">
							<i class="fa fa-ban"></i> Clear
						</button>
					</div>
				</div>
			</div>

		</form>

	</div>

	<script type="text/javascript" layout:fragment="scriptArea">
		$(document).ready(function() {
			$('.active').removeClass('active');
			$('#office_register').addClass('active');
		});
		function clearErrorMsg() {
			var errorMsg = document.getElementById("errorMsg");
			var successMsg = document.getElementById("successMsg");
			
			if (errorMsg != null) {
				document.getElementById("errorMsg").style.visibility = "hidden";
				document.getElementById("errorMsg").innerHTML = "";
				document.getElementById("errorMsg").classList
						.remove("alerterror");
			}
			if (successMsg != null) {
				document.getElementById("successMsg").style.visibility = "hidden";
				document.getElementById("successMsg").innerHTML = "";
				document.getElementById("successMsg").classList
						.remove("alertsuccess");
			}
			document.getElementById("office_code").style.borderColor = "";
			document.getElementById("office_code_msg").innerHTML = "";

			document.getElementById("office_name").style.borderColor = "";
			document.getElementById("office_name_msg").innerHTML = " ";

			document.getElementById("office_email_address").style.borderColor = "";
			document.getElementById("office_email_address_msg").innerHTML = " ";

			document.getElementById("office_city").style.borderColor = "";
			document.getElementById("office_city_msg").innerHTML = " ";

			document.getElementById("office_phone_number").style.borderColor = "";
			document.getElementById("office_phone_msg").innerHTML = " ";

			document.getElementById("office_address").style.borderColor = "";
			document.getElementById("office_address_msg").innerHTML = " ";

			document.getElementById("file-input").style.borderColor = "";
			document.getElementById("office_image_name_msg").innerHTML = "";
		}
		function checkValidate() {
			var officecodeMsg = "[[${E000018}]]"
			var officenameMsg = "[[${E000019}]]";
			var officephoneMsg = "[[${E000021}]]";
			var officeaddressMsg = "[[${E000022}]]";
			var officeemailaddressMsg = "[[${E000020}]]";
			var officecityMsg = "[[${E000023}]]";
			var emailErrMsg = "[[${E000101}]]";
			var phnoErrMsg = "[[${E000102}]]";
			var imageMsg = "[[${E000103}]]";

			var officecode = document.getElementById("office_code").value.trim();
			var officename = document.getElementById("office_name").value.trim();
			var officephone = document.getElementById("office_phone_number").value.trim();
			var officeaddress = document.getElementById("office_address").value.trim();
			var officeemailaddress = document
					.getElementById("office_email_address").value.trim();
			var officecity = document.getElementById("office_city").value.trim();
			var imgFile = document.getElementById('file-input');

			if (officecode == "") {
				document.getElementById("office_code").style.borderColor = "red";
				document.getElementById("office_code_msg").innerHTML = officecodeMsg;
				$("#office_code").focus();
				return false;
			}
			
			else if (officename == "") {
				document.getElementById("office_name").style.borderColor = "red";
				document.getElementById("office_name_msg").innerHTML = officenameMsg;
				$("#office_name").focus();
				return false;
			}
			else if (officeemailaddress == "") {
				document.getElementById("office_email_address").style.borderColor = "red";
				document.getElementById("office_email_address_msg").innerHTML = officeemailaddressMsg;
				$("#office_email_address").focus();
				return false;
			}
			else if (validateEmail(officeemailaddress) == false) {
				document.getElementById("office_email_address").style.borderColor = "red";
				document.getElementById("office_email_address_msg").innerHTML = emailErrMsg;
				$("#office_email_address").focus();
				return false;
			}
			else if (officecity == "") {
				document.getElementById("office_city").style.borderColor = "red";
				document.getElementById("office_city_msg").innerHTML = officecityMsg;
				$("#office_city").focus();
				return false;
			}
			else if (officephone == "") {
				document.getElementById("office_phone_number").style.borderColor = "red";
				document.getElementById("office_phone_msg").innerHTML = officephoneMsg;
				$("#office_phone_number").focus();
				return false;
			}
			else if (checkPhone(officephone) == false) {
				document.getElementById("office_phone_number").style.borderColor = "red";
				document.getElementById("office_phone_msg").innerHTML = phnoErrMsg;
				$("#office_phone_number").focus();
				return false;
			}
			else if (officeaddress == "") {
				document.getElementById("office_address").style.borderColor = "red";
				document.getElementById("office_address_msg").innerHTML = officeaddressMsg;
				$("#office_address").focus();
				return false;
			}
			else if (imgFile.files.length == 0) {
				document.getElementById("file-input").style.borderColor = "red";
				document.getElementById("office_image_name_msg").innerHTML = imageMsg;
				return false;
			}
			else {
			return true;
			}
		}
		function validateEmail(officeemailaddress) {
			const re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
			return re.test(officeemailaddress);
		}
		function checkPhone(officephone){
			var numbers = /^[0-9]+,?[0-9]+?$/; 
			if(officephone.match(numbers)){
				return true;
			}
			else{
				return false;	
			}
		}
		
		function previewFile(input) {
			var imageMsg = "[[${E000103}]]";
			var imgFile = document.getElementById('file-input');
			if (imgFile.files.length == 0) {
				//document.getElementById("office_image_msg").innerHTML = imageMsg;
				fileLabel.innerHTML = "No file chosen(jpg/jpeg/png/bmp/gif)";
			} else {
				var theSplit = imgFile.value.split('\\');
				fileLabel.innerHTML = theSplit[theSplit.length - 1];
				var ext = input.value.split('.');
				ext = ext[ext.length - 1].toLowerCase();
				var arrayExtensions = [ 'jpg', 'jpeg', 'png', 'bmp', 'gif' ];
				if (arrayExtensions.lastIndexOf(ext) == -1) {
					document.getElementById("errorMsg").className = "alerterror";
					document.getElementById("errorMsg").style.visibility = "visible";
					document.getElementById("errorMsg").innerHTML = image;
					document.getElementById("errorMsg").style.display = "block";
					input.value = '';
					fileLabel.innerHTML = "No file chosen(jpg/jpeg/png/bmp/gif)";
				}
			}
		}
		function clearing() {
			$('#office_code').attr('value', '');
			$('#office_name').attr('value', '');
			$('#office_email_address').attr('value', '');
			$('#office_city').attr('value', '');
			$('#office_phone_number').attr('value', '');
			$('#office_address').attr('value', '');
		}
	</script>


</body>
</html>